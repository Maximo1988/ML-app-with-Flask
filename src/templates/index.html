<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ML App with Flask</title>
  </head>
  <body>
    <main>
      <h1>ML App with Flask</h1>
      <p>Predicci贸n del tipo de medicamento con Random Forest.</p>
      <p>Servidor listo para ejecutarse con Waitress.</p>

      <h2>Modelo</h2>
      <p><strong>Algoritmo:</strong> RandomForestClassifier</p>
      <p><strong>Accuracy (test):</strong> {{ model_accuracy }}</p>

      <h2>Ingresar datos del paciente</h2>
      <form method="post">
        <label for="Age">Edad:</label>
        <input id="Age" name="Age" type="number" min="1" max="120" required value="{{ form_data.Age }}" />

        <br /><br />

        <label for="Sex">Sexo:</label>
        <select id="Sex" name="Sex">
          <option value="M" {% if form_data.Sex == "M" %}selected{% endif %}>M</option>
          <option value="F" {% if form_data.Sex == "F" %}selected{% endif %}>F</option>
        </select>

        <br /><br />

        <label for="BP">Presi贸n arterial:</label>
        <select id="BP" name="BP">
          <option value="HIGH" {% if form_data.BP == "HIGH" %}selected{% endif %}>HIGH</option>
          <option value="NORMAL" {% if form_data.BP == "NORMAL" %}selected{% endif %}>NORMAL</option>
          <option value="LOW" {% if form_data.BP == "LOW" %}selected{% endif %}>LOW</option>
        </select>

        <br /><br />

        <label for="Cholesterol">Colesterol:</label>
        <select id="Cholesterol" name="Cholesterol">
          <option value="HIGH" {% if form_data.Cholesterol == "HIGH" %}selected{% endif %}>HIGH</option>
          <option value="NORMAL" {% if form_data.Cholesterol == "NORMAL" %}selected{% endif %}>NORMAL</option>
        </select>

        <br /><br />

        <label for="Na_to_K">Relaci贸n Na_to_K:</label>
        <input id="Na_to_K" name="Na_to_K" type="number" step="0.001" required value="{{ form_data.Na_to_K }}" />

        <br /><br />
        <button type="submit">Predecir medicamento</button>
      </form>

      {% if form_error %}
      <p><strong>Error:</strong> {{ form_error }}</p>
      {% endif %}

      {% if predicted_drug %}
      <h3>Resultado de predicci贸n</h3>
      <p><strong>Medicamento sugerido:</strong> {{ predicted_drug }}</p>
      <p><strong>Confianza estimada:</strong> {{ prediction_confidence }}%</p>
      {% endif %}

      <h2>Resumen del dataset</h2>
      <ul>
        <li><strong>Archivo:</strong> {{ dataset_info.filename }}</li>
        <li><strong>Filas:</strong> {{ dataset_info.rows }}</li>
        <li><strong>Columnas:</strong> {{ dataset_info.columns }}</li>
      </ul>

      <h3>Vista previa (10 filas)</h3>
      {{ dataset_info.table_html | safe }}
    </main>
  </body>
</html>
